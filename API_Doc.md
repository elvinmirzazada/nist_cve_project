# API Documentation

## Endpoints
1. Retrieve CVE by ID


    GET /cve/{cve_id}

Description: Retrieve details of a specific CVE.

Request Parameters:

    cve_id (string): The ID of the CVE.

Response:

    {
      "cve_id": "CVE-2021-12345",
      "source_identifier": "source@example.com",
      "vuln_status": "Analyzed",
      "published": "2021-01-01T00:00:00Z",
      "last_modified": "2021-01-02T00:00:00Z",
      "evaluator_comment": "Sample comment",
      "evaluator_solution": "Sample solution",
      "evaluator_impact": "Sample impact",
      "cisa_exploit_add": "2021-01-03",
      "cisa_action_due": "2021-01-04",
      "cisa_required_action": "Sample action",
      "cisa_vulnerability_name": "Sample vulnerability name"
    }

2. Severity Distribution 


    GET /analytics/severity_distribution

Description: Get the count of vulnerabilities by severity.

Response:

    [
      {"severity": "HIGH", "count": 123},
      {"severity": "MEDIUM", "count": 456}
    ]

3. Worst Products


    GET /analytics/worst_products/{top_n}

Description: Get top n products with most vulnerabilities.

Request Parameters:

    top_n (integer): Number of top products to retrieve.

Response:


    [
      {"product": "Product1", "vulnerability_count": 10},
      {"product": "Product2", "vulnerability_count": 8}
    ]

4. Top 10 Vulnerabilities by Impact


    GET /analytics/top_impacts/{top_n}

Description: Get top n vulnerabilities by impact score.

Request Parameters:

    top_n (integer): Number of top vulnerabilities to retrieve.

Response:


    [
      {"cve_id": "CVE-2021-12345", "max_impact_score": 9.8},
      {"cve_id": "CVE-2021-67890", "max_impact_score": 9.7}
    ]

5. Top 10 Vulnerabilities by Exploitability


    GET /analytics/top_exploitability/{top_n}

Description: Get top n vulnerabilities by exploitability score.

Request Parameters:

    top_n (integer): Number of top vulnerabilities to retrieve.

Response:



    [
      {"cve_id": "CVE-2021-12345", "max_exploitability_score": 8.9},
      {"cve_id": "CVE-2021-67890", "max_exploitability_score": 8.8}
    ]

6. Top Attack Vectors


    GET /analytics/top_attack_vectors/{top_n}

Description: Get top n attack vectors.

Request Parameters:

    top_n (integer): Number of top attack vectors to retrieve.

Response:



    [
      {"attack_vector": "Network", "count": 100},
      {"attack_vector": "Local", "count": 50}
    ]

### Setup Instructions

Clone the repository:

    git clone <repository_url>
    cd nist_cve_project

Set up a virtual environment:

    python -m venv venv
    source venv/bin/activate  
    # On Windows use `venv\Scripts\activate`

Install dependencies:

    pip install fastapi uvicorn psycopg2

Run the FastAPI server:

    uvicorn main:app --reload

Access the API documentation:
    Open your browser and navigate to http://127.0.0.1:8000/docs for interactive API documentation.

Explanation

    FastAPI is used to create the API.
    PostgreSQL is the database used to store CVE data.
    Endpoints are created for querying CVE details and answering analytical questions about vulnerabilities.
    Interactive documentation is automatically generated by FastAPI at /docs.

## Adjust the database connection details and other configurations as needed.